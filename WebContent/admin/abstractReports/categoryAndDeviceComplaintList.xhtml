<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<title>Tamil Nadu Generation and Distribution Corporation Limited (TANGEDCO)</title>

	<!-- CSS Files -->
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/all-stylesheets.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/layout.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/effect.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/flashy.min.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/count.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/ticker.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/leaflet.css" />

	<style>
.ui-datatable table {
	border-collapse: collapse;
}

.ui-datatable th, .ui-datatable td {
	border: 1px solid black !important;
}

.ui-datatable tbody tr {
	border-bottom: 1px solid black !important;
}

.details-grid {
	width: 100%;
	border-spacing: 0;
	margin-bottom: 10px;
	display: flex;
}

.compact-table .ui-datatable-tablewrapper table {
	border-collapse: collapse;
}

.compact-table .ui-datatable-tablewrapper td, .compact-table .ui-datatable-tablewrapper th
	{
	border: 2px solid black !important;
}

.details-grid td {
	padding: 4px 8px;
	vertical-align: top;
}

.label-bold {
	font-weight: bold;
	white-space: nowrap;
	width: 160px;
	padding-right: 10px;
}

.section-title {
	font-weight: bold;
	margin-bottom: 10px;
	display: block;
	font-size: 16px;
	color: #333; /* Darker text for better readability */
}

.sticky-header {
	position: sticky;
	top: 0;
	background: white !important;
	z-index: 100;
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
	background-color: white;
	font-size: 1rem !important;
}

.scrollable-container {
	width: 100%;
	height: calc(100vh - 100px);
	overflow: auto;
	border: 1px solid #ddd;
	margin-bottom: 20px;
}

.inner-scrollable {
	width: 100%;
	min-width: fit-content;
}

hr {
	margin: 10px 0; /* Reduced margin for horizontal lines */
	border: 0;
	border-top: 1px solid #ddd; /* Light gray line */
}

.ui-widget-header {
	background-color: #f5f5f5; /* Light gray background for headers */
	padding: 8px;
	border-bottom: 1px solid #ddd; /* Matching border for consistency */
}

.report-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	width: 100%;
}

.export-buttons {
	margin-left: auto; /* Moves buttons to the right */
	display: flex;
	gap: 10px; /* Adds spacing between buttons */
}

.report-container {
	overflow-x: auto;
	margin: 1rem 0;
	border: 1px solid #dee2e6;
	border-radius: 4px;
}

.data-table {
	table-layout: fixed;
	width: 100%;
	margin: 0;
	border-collapse: collapse;
}

.data-table th {
	font-size: 15px !important;
	word-break: break-word;
	font-weight: 300 !important;
	white-space: normal !important;
	word-wrap: break-word;
	background: #f8f9fa;
	vertical-align: top;
	text-align: left;
	padding: 10px 5px !important;
}

.data-table td {
	font-size: 15px !important;
	font-weight: 450 !important;
	padding: 10px 15px !important;
}

.wide-column {
	background-color: #e9ecef !important;
	text-align: left;
	font-weight: bold;
	border: 1px solid #ddd;
	width: 100px !important;
}

.medium-column {
	min-width: 200px;
	max-width: 300px;
	white-space: normal !important;
}

.data-table td {
	border: 1px solid #dee2e6;
	padding: 10px 10px !important;
	font-size: 5rem;
	vertical-align: top;
	white-space: normal !important;
	word-break: break-word;
}

.data-table tr:nth-child(even) {
	background-color: #f8f9fa;
}

.ui-panel-title {
	font-size: 1.2em;
	font-weight: 800;
	color: #2c3e50;
}

.ui-datatable thead th {
	display: table-cell !important;
}

#circleReportForm:reportTable_head tr th {
	padding: 10px 0 !important;
	font-size: 12px !important
}
#circleReportForm{
margin-top:-40px !important;
}


body .ui-dialog .ui-dialog-titlebar .ui-dialog-titlebar-icon .ui-icon-closethick
	{
	font-family: "primeicons" !important;
	display: block !important;
	background: none;
	font-weight: bold !important;
	border-radius: 30px !important;
}

.category-header {
	background-color: #e9ecef !important;
	text-align: left;
	font-weight: bold;
	border: 1px solid #ddd;
	width: 80px !important;
}

.section-header {
	font-weight: bold;
	font-size: 1.1rem;
	color: #2c3e50;
	margin-top: 15px;
	margin-bottom: 8px;
	text-transform: uppercase;
	border-bottom: 2px solid #2980b9;
	padding-bottom: 4px;
}

.details-table {
	width: 100%;
	border-collapse: collapse;
	margin-bottom: 10px;
}

.details-table td {
	padding: 10px;
	border-bottom: 1px solid #e0e0e0;
}

.field-label {
	font-weight: 600;
	color: #34495e;
	padding: 6px 10px;
	width: 30%;
	background-color: #f2f2f2;
	vertical-align: top;
}

.field-value {
	padding: 6px 10px;
	color: #2d3436;
	background-color: #fafafa;
	vertical-align: top;
}

.section-divider {
	margin: 15px 0;
	border-bottom: 1px dashed #ccc;
}
</style>
</h:head>

<h:body class="home-01">

	<!-- Include Header -->
	<ui:insert name="header">
		<ui:include src="/header.xhtml" />
	</ui:insert>

	<!-- Loading Dialog -->
	<p:ajaxStatus onstart="PF('statusDialog').show()"
		oncomplete="PF('statusDialog').hide()" />
	<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
		closable="false" resizable="false" showHeader="false">
		<p:graphicImage name="images/ajax-loader.gif" />
	</p:dialog>

	<h:form id="circleReportForm">
	 <div class="scrollable-container">
            <div class="inner-scrollable">
		<p:panel id="reportPanel" styleClass="mb-3">
			<f:facet name="header">
				<div class="report-header">
					<span style="margin-right: 20px;">Category wise Abstract For A Date Range And Device : #{categoryAndDeviceAbstract.selectedSectionName} </span>

					<p:commandButton value="Back" class="btn btn-md btn-info"
						actionListener="#{categoryAndDeviceAbstract.redirectToSectionReport()}"
						update="reportPanel reportTable" process="@form"
						onstart="PF('statusDialog').show()"
						oncomplete="PF('statusDialog').hide()" />

					<div class="export-buttons">
						<p:commandButton value="Export as Excel"
							actionListener="#{categoryAndDeviceAbstract.exportComplaintListToExcel(categoryAndDeviceAbstract.complaintList)}"
							ajax="false" styleClass="ui-button-success"
							style="margin-right: 20px;">
							<p:fileDownload value="#{categoryAndDeviceAbstract.excelFile}" />
						</p:commandButton>

						<p:commandButton value="Export as PDF"
							actionListener="#{categoryAndDeviceAbstract.exportComplaintListToPdf(categoryAndDeviceAbstract.complaintList)}"
							ajax="false" styleClass="ui-button-danger">
							<p:fileDownload value="#{categoryAndDeviceAbstract.pdfFile}" />
						</p:commandButton>
					</div>
				</div>
			</f:facet>

			<p:dataTable id="reportTable" var="report"
				value="#{categoryAndDeviceAbstract.complaintList}"
				styleClass="data-table" 
				paginator="true"
			    paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
			    rows="10"
			    rowsPerPageTemplate="5,10,15,20,50"
			    paginatorPosition="bottom"
				liveResizeMode="false"
				resizableColumns="false" showGridlines="true" rowIndexVar="rowIndex">

				<p:columnGroup type="header" class="sticky-header">
					<p:row>
						<p:column headerText="S.No"
							style="background:#1a237e !important;color:#fff !important; width: 40px; text-align: center;" />

						<p:column headerText="Complaint ID" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;" />

						<p:column headerText="Complaint Date" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />

						<p:column headerText="Complaint Mode" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />

						<p:column headerText="Consumer Number"
							styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />

						<p:column headerText="Consumer Details" styleClass="wide-column"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />

						<p:column headerText="Contact Number" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />

						<p:column headerText="Complaint Type" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />

						<p:column headerText="Complaint Description"
							styleClass="wide-column"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />

						<p:column headerText="Complaint Status"
							styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />

						<p:column headerText="Attended Date" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />


						<p:column headerText="Attended Remarks" styleClass="wide-column"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />
							
						<p:column headerText="Feedback" styleClass="wide-column"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />
							
						<p:column headerText="Region" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />
							
						<p:column headerText="Circle" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />
							
						<p:column headerText="Division" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />
							
						<p:column headerText="Sub Division" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />
							
						<p:column headerText="Section" styleClass="category-header"
							style="background:#1a237e !important;color:#fff !important;width :150px !important" />

					</p:row>


				</p:columnGroup>

				<p:column>
					<h:outputText value="#{rowIndex + 1}" />
				</p:column>

				<p:column styleClass="fixed-column-circle"
					style="text-align:left !important">
					<p:commandLink value="#{report.complaintId}"
						styleClass="link-class" oncomplete="PF('complaintDialog').show();"
						update=":circleReportForm:pnlcomp"
						action="#{categoryAndDeviceAbstract.getComplaintDetailForAbstractReport()}">
						<f:param name="complaintID" value="#{report.complaintId}" />
					</p:commandLink>
				</p:column>

				<p:column>
					<h:outputText value="#{report.createdOnFormatted}" />
				</p:column>
				
				<p:column>
					<h:outputText value="#{report.device}" />
				</p:column>
				
				<p:column>
					<h:outputText value="#{report.serviceNumber}" />
				</p:column>

				<p:column>
					<h:outputText value="#{report.serviceAddress}" />
				</p:column>

				<p:column>
					<h:outputText value="#{report.mobile}" />
				</p:column>

				<p:column>
					<h:outputText value="#{report.complaintType}" />
				</p:column>

				<p:column>
					<h:outputText value="#{report.complaintDescription}" />
				</p:column>
				
				<p:column>
					<h:outputText value="#{report.complaintStatusValue}" />
				</p:column>
				
				<p:column>
					<h:outputText value="#{report.attendedDate}" />
				</p:column>

				<p:column>
					<h:outputText value="#{report.attendedRemarks}" />
				</p:column>
				
				<p:column>
					<h:outputText value="#{report.feedbackRating}" />
				</p:column>
				
				<p:column>
					<h:outputText value="#{report.regionName}" />
				</p:column>

				<p:column>
					<h:outputText value="#{report.circleName}" />
				</p:column>
				<p:column>
					<h:outputText value="#{report.divisionName}" />
				</p:column>
				
				<p:column>
					<h:outputText value="#{report.subDivisionName}" />
				</p:column>

				<p:column>
					<h:outputText value="#{report.sectionName}" />
				</p:column>

			</p:dataTable>

		</p:panel>



		<p:dialog header="Complaint Details" widgetVar="complaintDialog"
			showEffect="drop" hideEffect="drop" draggable="true" modal="true"
			resizable="false" responsive="true"
			style="overflow-y: auto; max-height: 100vh;top:0 !important">

			<p:outputPanel id="pnlcomp">
				<!-- COMPLAINT DETAILS Section -->
				<div class="section-header">COMPLAINT STATUS :
					#{categoryAndDeviceAbstract.selectedComplaintId.complaintStatusValue}</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Complaint ID / Registered Date</td>
						<td class="field-value">
							#{categoryAndDeviceAbstract.selectedComplaintId.complaintId} / #{categoryAndDeviceAbstract.selectedComplaintId.createdOnFormatted}</td>
					</tr>
					<tr>
						<td class="field-label">Complaint Received Through</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.device}</td>
					</tr>
					<tr>
						<td class="field-label">Complaint Category</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.complaintType}</td>
					</tr>
					<tr>
						<td class="field-label">Sub Category</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.subCategoryName}</td>
					</tr>
					<tr>
						<td class="field-label">Description</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.complaintDescription}</td>
					</tr>
				</table>

				<div class="section-divider"></div>

				<!-- USER DETAILS Section -->
				<div class="section-header">USER DETAILS</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Name</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.serviceName}</td>
					</tr>
					<tr>
						<td class="field-label">Address</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.serviceAddress}</td>
					</tr>
					<tr>
						<td class="field-label">Mobile Number</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.mobile}</td>
					</tr>
					<tr>
						<td class="field-label">Registered Mobile Number</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.registeredMobileNumber}</td>
					</tr>
				</table>

				<div class="section-divider"></div>

				<!-- OFFICE DETAILS Section -->
				<div class="section-header">OFFICE DETAILS</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Region</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.regionName}</td>
					</tr>
					<tr>
						<td class="field-label">Circle</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.circleName}</td>
					</tr>
					<tr>
						<td class="field-label">Division</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.divisionName}</td>
					</tr>
					<tr>
						<td class="field-label">Sub Division</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.subDivisionName}</td>
					</tr>
					<tr>
						<td class="field-label">Section</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.sectionName}</td>
					</tr>
				</table>

				<div class="section-divider"></div>

				<!-- CLOSURE DETAILS Section -->
				<div class="section-header">CLOSURE DETAILS</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Closed Date</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.attendedDate}</td>
					</tr>
					<tr>
						<td class="field-label">Closed Remarks</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.attendedRemarks}</td>
					</tr>
				</table>

				<div class="section-divider"></div>

				<!-- FEEDBACK DETAILS Section -->
				<div class="section-header">FEEDBACK DETAILS</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Feedback Remarks</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.feedback}</td>
					</tr>
					<tr>
						<td class="field-label">Feedback Rating</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.feedbackRating}</td>
					</tr>
					<tr>
						<td class="field-label">Feedback Given Date</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.feedBackEntryDate}</td>
					</tr>
				</table>
				
				
				<!-- TRANSFER DETAILS Section -->
				<div class="section-header">TRANSFER DETAILS</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Transfer Date</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.complaintTransferedOn}</td>
					</tr>
					<tr>
						<td class="field-label">Transferred By</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.complaintTransferedBy}</td>
					</tr>
					<tr>
						<td class="field-label">Transfer Remarks</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.complaintTransferedRemarks}</td>
					</tr>
				</table>
				
				<!-- TRANSFER DETAILS Section -->
				<div class="section-header">QUALITY CHECK DETAILS</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Quality Checked Date</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.qcDate}</td>
					</tr>
					<tr>
						<td class="field-label">Quality Checked Status</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.qcStatus}</td>
					</tr>
					<tr>
						<td class="field-label">Quality Checked Remarks</td>
						<td class="field-value">#{categoryAndDeviceAbstract.selectedComplaintId.qcRemarks}</td>
					</tr>
				</table>
			</p:outputPanel>
		</p:dialog>	
</div>
</div>
	</h:form>
</h:body>
</html>