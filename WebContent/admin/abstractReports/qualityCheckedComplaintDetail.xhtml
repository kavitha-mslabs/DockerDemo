<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Tamil Nadu Generation and Distribution Corporation Limited (TANGEDCO)</title>

    <!-- CSS Files -->
    <link rel="stylesheet" href="#{request.contextPath}/resources/css/all-stylesheets.css" />
    <link rel="stylesheet" href="#{request.contextPath}/resources/css/layout.css" />
    <link rel="stylesheet" href="#{request.contextPath}/resources/css/effect.css" />
    <link rel="stylesheet" href="#{request.contextPath}/resources/css/flashy.min.css" />
    <link rel="stylesheet" href="#{request.contextPath}/resources/css/count.css" />
    <link rel="stylesheet" href="#{request.contextPath}/resources/css/ticker.css" />
    <link rel="stylesheet" href="#{request.contextPath}/resources/css/leaflet.css" />
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
            color: #333;
            line-height: 1.6;
        }
        .section-header {
            font-weight: bold;
            font-size: 1.1rem;
            color: #2c3e50;
            margin-top: 15px;
            margin-bottom: 8px;
            text-transform: uppercase;
            border-bottom: 2px solid #2980b9;
            padding-bottom: 4px;
        }
        
        .details-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
        }
        
        .details-table td {
            padding: 10px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .field-label {
            font-weight: 600;
            color: #34495e;
            padding: 6px 10px;
            width: 30%;
            background-color: #f2f2f2;
            vertical-align: top;
        }
        
        .field-value {
            padding: 6px 10px;
            color: #2d3436;
            background-color: #fafafa;
            vertical-align: top;
        }
        
        .section-divider {
            margin: 15px 0;
            border-bottom: 1px dashed #ccc;
        }

        .content-wrapper {
            max-width: 900px;
            margin: 20px auto;
            padding: 30px;
            background: #fff;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
        }

        .header-section {
            text-align: center;
            padding-bottom: 25px;
            border-bottom: 1px solid #e0e6ed;
        }

        .page-title {
            font-size: 25px;
            color: #2c3e50;
            font-weight: 600;
            margin: 0 0 16px 0;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-pending { background: #f39c12; color: white; }
        .status-resolved { background: #27ae60; color: white; }
        .status-processing { background: #3498db; color: white; }

        .section-card {
            margin-bottom: 25px;
            padding: 0;
            border-radius: 6px;
            background: #fff;
            border: 1px solid #e0e6ed;
            overflow: hidden;
        }

        .section-title {
            font-size: 16px;
            color: #fff;
            font-weight: 600;
            margin: 0;
            padding: 12px 20px;
            background: #1a237e;
            text-align: center;
        }

        .detail-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .detail-table tr {
            border-bottom: 1px solid #e0e6ed;
        }
        
        .detail-table tr:last-child {
            border-bottom: none;
        }
        
        .detail-label {
            width: 35%;
            padding: 12px 20px;
            font-weight: 500;
            color: #7f8c8d;
            vertical-align: top;
        }
        
        .detail-value {
            padding: 12px 20px;
            color: #2c3e50;
        }

        .back-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            margin-right: 20px;
            float: right;
        }
        
        .back-button:hover {
            background: #2980b9;
        }

        /* Registry table styles matching original */
        .registry-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .registry-table th {
            background-color: #1a237e;
            color: white;
            padding: 8px;
            text-align: left;
        }
        
        .registry-table td {
            padding: 8px;
            border-bottom: 1px solid #ddd;
        }
        
        .registry-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        /* Error message style */
        .error-message {
            text-align: center;
            padding: 20px;
            color: #e74c3c;
            font-size: 18px;
            font-weight: bold;
            margin: 30px 0;
            border: 1px solid #e74c3c;
            background-color: #fadbd8;
            border-radius: 4px;
        }
    </style>
</h:head>

<h:body>
    <ui:insert name="header">
		<ui:include src="/header.xhtml" />
    </ui:insert>

    <p:ajaxStatus onstart="PF('statusDialog').show()" oncomplete="PF('statusDialog').hide()" />
    <p:dialog widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
        <p:graphicImage name="images/ajax-loader.gif" />
    </p:dialog>

    <div class="content-wrapper">
        <h:form id="singleComplaintForm">
            <p:commandButton value="Back" 
                     action="#{complaintQualityChecked.returnComplaintQcPage}"
                     styleClass="back-button"
                     immediate="true" />
            
            <ui:fragment rendered="#{not empty complaintQualityChecked.complaint.complaintId}">
                <div class="section-header" style="padding:0 0 25px !important; text-align :center !important;">COMPLAINT STATUS :
                    #{complaintQualityChecked.complaint.complaintStatusValue}</div>
                <table class="details-table">
                    <tr>
                        <td class="field-label">Complaint ID / Registered Date</td>
                        <td class="field-value">
                            #{complaintQualityChecked.complaint.complaintId} / #{complaintQualityChecked.complaint.createdOnFormatted}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Complaint Received Through</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.device}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Complaint Category</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.complaintType}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Sub Category</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.subCategoryName}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Description</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.complaintDescription}</td>
                    </tr>
                </table>

                <div class="section-divider"></div>

                <!-- USER DETAILS Section -->
                <div class="section-header">USER DETAILS</div>
                <table class="details-table">
                    <tr>
                        <td class="field-label">Name</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.serviceName}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Address</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.serviceAddress}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Contact Number</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.mobile}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Alternate Mobile Number</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.registeredMobileNumber}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Consumer Number</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.serviceNumber}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Distribution Name</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.distribution}</td>
                    </tr>
                </table>

                <div class="section-divider"></div>

                <!-- OFFICE DETAILS Section -->
                <div class="section-header">OFFICE DETAILS</div>
                <table class="details-table">
                    <tr>
                        <td class="field-label">Region</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.regionName}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Circle</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.circleName}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Division</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.divisionName}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Sub Division</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.subDivisionName}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Section</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.sectionName}</td>
                    </tr>
                </table>

                <div class="section-divider"></div>

                <!-- CLOSURE DETAILS Section -->
                <div class="section-header">CLOSURE DETAILS</div>
                <table class="details-table">
                    <tr>
                        <td class="field-label">Closed Date</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.attendedDate}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Closed Remarks</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.attendedRemarks}</td>
                    </tr>
                </table>

                <div class="section-divider"></div>

                <!-- FEEDBACK DETAILS Section -->
                <div class="section-header">FEEDBACK DETAILS</div>
                <table class="details-table">
                    <tr>
                        <td class="field-label">Feedback Remarks</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.feedback}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Feedback Rating</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.feedbackRating}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Feedback Given Date</td>
                        <td class="field-value">#{complaintQualityChecked.complaint.feedBackEntryDate}</td>
                    </tr>
                </table>
                
                
                <!-- TRANSFER DETAILS Section -->
                <div class="section-header">TRANSFER HISTORY</div>
                <p:dataTable value="#{complaintQualityChecked.complaint.transferDetails}" var="transfer"
                             styleClass="details-table" rowIndexVar="rowIndex">
                    <p:column headerText="S.No">
                        <h:outputText value="#{rowIndex + 1}"/>
                    </p:column>
                    <p:column headerText="Transfer Date">
                        <h:outputText value="#{transfer.transferDate}"/>
                    </p:column>
                    <p:column headerText="Transferred By">
                        <h:outputText value="#{transfer.transferredBy}"/>
                    </p:column>
                    <p:column headerText="Remarks">
                        <h:outputText value="#{transfer.transferRemarks}"/>
                    </p:column>
                </p:dataTable>
                
                 <!-- RESEND DETAILS Section -->
                <div class="section-header">RESEND HISTORY</div>
                <p:dataTable value="#{complaintQualityChecked.complaint.resendDetails}" var="resend"
                             styleClass="details-table" rowIndexVar="rowIndex">
                    <p:column headerText="S.No">
                        <h:outputText value="#{rowIndex + 1}"/>
                    </p:column>
                    <p:column headerText="Resend Date">
                        <h:outputText value="#{resend.resendDate}"/>
                    </p:column>
                    <p:column headerText="Resended By">
                        <h:outputText value="#{resend.resendedBy}"/>
                    </p:column>
                    <p:column headerText="Remarks">
                        <h:outputText value="#{resend.resendRemarks}"/>
                    </p:column>
                </p:dataTable>

                <!-- QUALITY CHECK DETAILS Section -->
                <div class="section-header">QUALITY CHECKS</div>
                <p:dataTable value="#{complaintQualityChecked.complaint.qualityCheckDetails}" var="qc"
                             styleClass="details-table" rowIndexVar="rowIndex">
                    <p:column headerText="S.No">
                        <h:outputText value="#{rowIndex + 1}"/>
                    </p:column>
                    <p:column headerText="QC Date">
                        <h:outputText value="#{qc.qcDate}"/>
                    </p:column>
                    <p:column headerText="Status">
                        <h:outputText value="#{qc.qcStatus}"/>
                    </p:column>
                    <p:column headerText="Remarks">
                        <h:outputText value="#{qc.qcRemarks}"/>
                    </p:column>
                </p:dataTable>
                
                                                                <div class="section-divider"></div>
<div class="section-header">IMAGES DURING REGISTRATION</div>

<!-- For Image 1 -->
<ui:fragment rendered="#{not empty complaintQualityChecked.complaint.image1}">
    <div style="margin-bottom: 20px;">
        <h6 style="margin-bottom: 8px; color: #444;">Image 1</h6>
<!--         <div style="display: flex; flex-direction: column; gap: 5px;"> -->
            <img src="/ccms_images/#{complaintQualityChecked.getImagePath(complaintQualityChecked.complaint.image1)}"
                alt="#{complaintQualityChecked.complaint.image1}"
                style="max-width: 500px; max-height: 400px; border: 1px solid #ddd; padding: 5px;"/>
       <!--  </div> -->
    </div>
</ui:fragment>

<!-- For Image 2 -->
<ui:fragment rendered="#{not empty complaintQualityChecked.complaint.image2}">
    <div style="margin-bottom: 20px;">
        <h6 style="margin-bottom: 8px; color: #444;">Image 2</h6>
       <!--  <div style="display: flex; flex-direction: column; gap: 5px;"> -->
            <img src="/ccms_images/#{complaintQualityChecked.getImagePath(complaintQualityChecked.complaint.image2)}"
                 alt="#{complaintQualityChecked.complaint.image2}"
                style="max-width: 500px; max-height: 400px; border: 1px solid #ddd; padding: 5px;"/>
      <!--   </div> -->
    </div>
</ui:fragment>

<ui:fragment rendered="#{empty complaintQualityChecked.complaint.image1 and empty complaintQualityChecked.complaint.image2}">
    <div style="padding: 15px; background: #f5f5f5; border-radius: 4px; text-align: center; color: #666;">
        No complaint registration images available
    </div>
</ui:fragment>

<div class="section-divider"></div>
<div class="section-header">CLOSURE IMAGE</div>

<ui:fragment rendered="#{not empty complaintQualityChecked.complaint.closureImage}">
    <div style="margin-bottom: 20px;">
        <!-- <div style="display: flex; flex-direction: column; gap: 5px;"> -->
            <img src="/ccms_images/#{complaintQualityChecked.getImagePath(complaintQualityChecked.complaint.closureImage)}"
                 alt="#{complaintQualityChecked.complaint.closureImage}"
                 style="max-width: 500px; max-height: 400px; border: 1px solid #ddd; padding: 5px;" />
        <!-- </div> -->
    </div>
</ui:fragment>

<ui:fragment rendered="#{empty complaintQualityChecked.complaint.closureImage}">
    <div style="padding: 15px; background: #f5f5f5; border-radius: 4px; text-align: center; color: #666;">
        No closure image available
    </div>
</ui:fragment>
                
                
            </ui:fragment>
        </h:form>
    </div>
</h:body>
<script>
function clearSearchFilter(){
    window.location.reload();
}
</script>
</html>