<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<title>Tamil Nadu Generation and Distribution Corporation
		Limited (TANGEDCO)</title>

	<!-- CSS Files -->
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/all-stylesheets.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/layout.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/effect.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/flashy.min.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/count.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/ticker.css" />
	<link rel="stylesheet"
		href="#{request.contextPath}/resources/css/leaflet.css" />

	<style>
body {
	font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
	background-color: #f8f9fa;
	margin: 0;
	padding: 0;
	color: #333;
	line-height: 1.6;
}
/* Custom file upload styling */
.file-upload-wrapper {
    height: 46px;
    display: flex;
    align-items: center;
}

.custom-file-upload {
    width: 100%;
}

.custom-file-upload .ui-fileupload-buttonbar {
    border: none;
    background: transparent;
    padding: 0;
    display: flex;
    height: 100%;
}

.custom-file-upload .ui-fileupload-choose {
    height: 100%;
    padding: 0 1rem;
    border: 1px solid #ced4da;
    border-radius: 4px 0 0 4px;
    background: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 120px;
}

.custom-file-upload .ui-fileupload-content {
    display: none; /* Hide additional content */
}

.custom-file-upload .ui-fileupload-filename {
    padding: 0 1rem;
    height: 100%;
    display: flex;
    align-items: center;
    border: 1px solid #ced4da;
    border-left: none;
    border-radius: 0 4px 4px 0;
    background: white;
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.custom-file-upload .ui-button-text {
    padding: 0;
}

/* Hover and focus states */
.custom-file-upload .ui-fileupload-choose:hover {
    background: #e9ecef;
}

.custom-file-upload .ui-state-focus .ui-fileupload-choose {
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}
.section-header {
	font-weight: bold;
	font-size: 1.1rem;
	color: #2c3e50;
	margin-top: 15px;
	margin-bottom: 8px;
	text-transform: uppercase;
	border-bottom: 2px solid #2980b9;
	padding-bottom: 4px;
}

.details-table {
	width: 100%;
	border-collapse: collapse;
	margin-bottom: 10px;
}

.details-table td {
	padding: 10px;
	border-bottom: 1px solid #e0e0e0;
}

.field-label {
	font-weight: 600;
	color: #34495e;
	padding: 6px 10px;
	width: 30%;
	background-color: #f2f2f2;
	vertical-align: top;
}

.field-value {
	padding: 6px 10px;
	color: #2d3436;
	background-color: #fafafa;
	vertical-align: top;
}

.section-divider {
	margin: 15px 0;
	border-bottom: 1px dashed #ccc;
}

.content-wrapper {
	max-width: 900px;
	margin: 20px auto;
	padding: 30px;
	background: #fff;
	box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
	border-radius: 8px;
}

.header-section {
	text-align: center;
	padding-bottom: 25px;
	border-bottom: 1px solid #e0e6ed;
}

.page-title {
	font-size: 25px;
	color: #2c3e50;
	font-weight: 600;
	margin: 0 0 16px 0;
}

.status-badge {
	display: inline-block;
	padding: 4px 10px;
	border-radius: 12px;
	font-size: 12px;
	font-weight: 500;
	text-transform: uppercase;
	letter-spacing: 0.5px;
}

.status-pending {
	background: #f39c12;
	color: white;
}

.status-resolved {
	background: #27ae60;
	color: white;
}

.status-processing {
	background: #3498db;
	color: white;
}

.section-card {
	margin-bottom: 25px;
	padding: 0;
	border-radius: 6px;
	background: #fff;
	border: 1px solid #e0e6ed;
	overflow: hidden;
}

.section-title {
	font-size: 16px;
	color: #fff;
	font-weight: 600;
	margin: 0;
	padding: 12px 20px;
	background: #1a237e;
	text-align: center;
}

.detail-table {
	width: 100%;
	border-collapse: collapse;
}

.detail-table tr {
	border-bottom: 1px solid #e0e6ed;
}

.detail-table tr:last-child {
	border-bottom: none;
}
 .ui-fileupload-buttonbar .ui-fileupload-upload {
    display: none !important;
  }

.detail-label {
	width: 35%;
	padding: 12px 20px;
	font-weight: 500;
	color: #7f8c8d;
	vertical-align: top;
}

.detail-value {
	padding: 12px 20px;
	color: #2c3e50;
}

.back-button {
	background: #3498db;
	color: white;
	border: none;
	padding: 8px 16px;
	border-radius: 4px;
	cursor: pointer;
	font-size: 14px;
	transition: all 0.3s ease;
	margin-right: 20px;
	float: right;
}
 .hide-upload-button .ui-fileupload-buttonbar,
    .hide-upload-button .ui-fileupload-content {
        border: none !important;
    }
.back-button:hover {
	background: #2980b9;
}

/* Registry table styles matching original */
.registry-table {
	width: 100%;
	border-collapse: collapse;
	margin: 15px 0;
}

.registry-table th {
	background-color: #1a237e;
	color: white;
	padding: 8px;
	text-align: left;
}

.registry-table td {
	padding: 8px;
	border-bottom: 1px solid #ddd;
}

.registry-table tr:nth-child(even) {
	background-color: #f2f2f2;
}

/* Error message style */
.error-message {
	text-align: center;
	padding: 20px;
	color: #e74c3c;
	font-size: 18px;
	font-weight: bold;
	margin: 30px 0;
	border: 1px solid #e74c3c;
	background-color: #fadbd8;
	border-radius: 4px;
}
/* Hide the icon in the "Choose" button */
.ui-fileupload-choose .ui-icon {
    display: none !important;
}

/* Hide the icon in the "Cancel" button */
.ui-fileupload-cancel .ui-icon {
    display: none !important;
}
.ui-progressbar {
    display: none !important;
}
.ui-fileupload-cancel .ui-icon {
    display: none !important;
}

.ui-fileupload-files .ui-fileupload-file img {
    max-width: none !important;
    max-height: none !important;
    width: auto !important;
    height: auto !important;
}


</style>
	<script type="text/javascript">
		function selecttype() {
			var image = document
			.getElementById("singleComplaintForm:image");
			var errorMsg = document
					.getElementById("singleComplaintForm:errorMsg");
			var ctypeWidget = PF('ctypeWidget').getSelectedValue();
			var reasonWidget = PF('reasonWidget').getSelectedValue();
			var errorMsgreason = document
					.getElementById("singleComplaintForm:errorMsgreason");
			if (ctypeWidget != "") {
				if (ctypeWidget == 2) {
					
					  document.getElementById("myDiv").style.display = "block";
					PF('reasonWidget').enable();
					if (reasonWidget == "") {
						errorMsgreason.style.display = "block";
					} else {
						errorMsgreason.style.display = "none";
					}
				} else {
					PF('reasonWidget').disable(); // disable dropdown
					errorMsgreason.style.display = "none";
					
					  document.getElementById("myDiv").style.display = "none";
				}
				errorMsg.style.display = "none";
			} else {
				errorMsg.style.display = "block";
			}

		}
		function validateCloseComplaint() {

			var ctypeWidget = PF('ctypeWidget').getSelectedValue();
			var errorMsg = document
					.getElementById("singleComplaintForm:errorMsg");
			//var completionReason = document.getElementById("complaintForm:ddCompletionReason");
			var remarks = document
					.getElementById("singleComplaintForm:remarkId");
			var reasonWidget = PF('reasonWidget').getSelectedValue();
			var errorMsgreason = document
					.getElementById("singleComplaintForm:errorMsgreason");

			if (ctypeWidget == "") {
				errorMsg.style.display = "block";
			}
			if (ctypeWidget != "") {
				errorMsg.style.display = "none";

				if (ctypeWidget == 2) {

					PF('reasonWidget').enable();
					if (reasonWidget == "") {
						errorMsgreason.style.display = "block";
					} else {
						errorMsgreason.style.display = "none";
					}

				} else {
					PF('reasonWidget').disable(); // disable dropdown
					errorMsgreason.style.display = "none";
				}

			}

			if (remarks.value == "") {
				showErrorMessage(remarks.id, remarks.value, "Description");

			}
			if (remarks.value != "") {
				clearErrorMessage(remarks.id);

			}
			if (remarks.value == "" || ctypeWidget == "") {

				return false;
			}
			return true;
		}
		function clearErrorMessage(tagid) {
			$('[id="span' + tagid + '"]').remove();
		}

		function toggleIframe(iframeId) {
			const iframeContainer = document.getElementById('iframeContainer');
			if (iframeContainer.style.display === 'none') {
				iframeContainer.style.display = 'block';
			} else {
				iframeContainer.style.display = 'none';
			}
		}

		function toggleIframeVisibility() {
			var iframeContainer = document.getElementById("iframeContainer");

			// Toggle the display property to show or hide the iframe
			if (iframeContainer.style.display === "none"
					|| iframeContainer.style.display === "") {
				iframeContainer.style.display = "block";
			} else {
				iframeContainer.style.display = "none";
			}
		}

		function validateRemarks() {
			const remarksField = document
					.getElementById("singleComplaintForm:remarks");
			if (remarksField.value == "") {
				showErrorMessage(remarksField.id, remarksField.value, $(
						remarksField).prev().text());

				return false;
			}
			return true;
		}

		function showErrorMessage(fieldId, fieldValue, fieldLabel) {
			if (fieldValue === "" || fieldValue === null) {
				$('[id="span' + fieldId + '"]').remove();
				$('[id="' + fieldId + '"]').after(
						"&lt;span style='color:red;' id='span" + fieldId
								+ "'&gt;Please Enter " + fieldLabel
								+ "&lt;/span&gt;");
			} else if (fieldValue != "" || fieldValue != null) {
				$('[id="span' + fieldId + '"]').remove();
			}
		}

		function resetClosureForm() {
			// Reset the closure type dropdown
			PF('ctypeWidget').selectValue('');

			// Reset the closure reason dropdown
			PF('reasonWidget').selectValue('');
			PF('reasonWidget').disable(); // optional: disable it if needed initially

			// Clear the textarea
			document.getElementById('singleComplaintForm:remarkId').value = '';

			// Reset the character counter (if needed)
			document.getElementById('singleComplaintForm:displayClose').innerText = '250 characters remaining.';

			// Hide error messages
			document.getElementById('singleComplaintForm:errorMsg').style.display = 'none';
			document.getElementById('singleComplaintForm:errorMsgreason').style.display = 'none';

			// Clear custom error highlights if any
			clearErrorMessage('singleComplaintForm:remarkId');
		}

		function reload() {
			location.reload();

		}
		function previewImage() {
			alert("afadf");
		  
		  }
		document.addEventListener('change', function (e) {
		    if (e.target.matches('.custom-file-upload input[type="file"]')) {
		        const file = e.target.files[0];
		        if (file &amp;&amp; file.size &gt; 1048576) {//file is too large (greater than 1MB) — reject it
		           
		            e.target.value = ''; // Clear the file
		            const fileNameSpan = e.target.closest('.custom-file-upload')
                    .querySelector('.ui-fileupload-filename');
			if (fileNameSpan) {
			fileNameSpan.textContent = '';
			}
			if (window.PF) {
			    PF('filesize').show();

			    // Auto-close after 5 seconds (5000 milliseconds)
			    setTimeout(function () {
			        PF('filesize').hide();
			    }, 5000);
			}
		            return;

		        }
		        else {
		            // Optional: show preview if file size is okay
		            const reader = new FileReader();
		            reader.onload = function(event) {
		                const preview = document.getElementById('imagePreview');
		                if (preview) {
		                    preview.src = event.target.result;
		                    preview.style.display = 'block';
		                }
		            }
		            reader.readAsDataURL(file);
		        }
		    }
		    
		});
	</script>
</h:head>

<h:body>
	<ui:insert name="header">
		<ui:include src="../callcenterheader.xhtml" />
	</ui:insert>

	<p:ajaxStatus onstart="PF('statusDialog').show()"
		oncomplete="PF('statusDialog').hide()" />
	<p:dialog widgetVar="statusDialog" modal="true" draggable="false"
		closable="false" resizable="false" showHeader="false">
		<p:graphicImage name="images/ajax-loader.gif" />
	</p:dialog>

	<div class="content-wrapper">
		<h:form id="singleComplaintForm" enctype="multipart/form-data">

			<br />
			<p:growl id="messages" styleClass="ng-deep" showDetail="true" />
			<!-- <p:commandLink value="#{singleComplaintReport.complaints.complaintId}" 
                   styleClass="link-class"
                  
                   actionListener="#{singleComplaintReport.fetchComplaintsDetails}">
        <f:param name="complaintId" value="#{singleComplaintReport.complaints.complaintId}" />
    </p:commandLink>-->
			<p:commandButton value="Back"
				action="#{singleComplaintReport.returnToSearchPageclose}"
				styleClass="back-button" immediate="true" />


			<ui:fragment
				rendered="#{not empty singleComplaintReport.complaints.complaintId}">
				<div class="section-header"
					style="padding: 0 0 25px !important; text-align: center !important;">COMPLAINT
					STATUS : #{singleComplaintReport.complaints.complaintStatusValue}</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Complaint ID / Registered Date</td>
						<td class="field-value">
							#{singleComplaintReport.complaints.complaintId} /
							#{singleComplaintReport.complaints.createdOnFormatted}</td>
					</tr>
					<tr>
						<td class="field-label">Complaint Received Through</td>
						<td class="field-value">#{singleComplaintReport.complaints.device}</td>
					</tr>
					<tr>
						<td class="field-label">Complaint Category</td>
						<td class="field-value">#{singleComplaintReport.complaints.complaintType}</td>
					</tr>
					<tr>
						<td class="field-label">Sub Category</td>
						<td class="field-value">#{singleComplaintReport.complaints.subCategoryName}</td>
					</tr>
					<tr>
						<td class="field-label">Description</td>
						<td class="field-value">#{singleComplaintReport.complaints.complaintDescription}</td>
					</tr>
				</table>

				<div class="section-divider"></div>

				<!-- USER DETAILS Section -->
				<div class="section-header">USER DETAILS</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Name</td>
						<td class="field-value">#{singleComplaintReport.complaints.serviceName}</td>
					</tr>
					<tr>
						<td class="field-label">Address</td>
						<td class="field-value">#{singleComplaintReport.complaints.serviceAddress}</td>
					</tr>
					<tr>
						<td class="field-label">Contact Number</td>
						<td class="field-value">#{singleComplaintReport.complaints.mobile}</td>
					</tr>
					<tr>
						<td class="field-label">Alternate Mobile Number</td>
						<td class="field-value">#{singleComplaintReport.complaints.registeredMobileNumber}</td>
					</tr>
					<tr>
						<td class="field-label">Consumer Number</td>
						<td class="field-value">#{singleComplaintReport.complaints.serviceNumber}</td>
					</tr>
					<tr>
						<td class="field-label">Distribution Name</td>
						<td class="field-value">#{singleComplaintReport.complaints.distribution}</td>
					</tr>
				</table>

				<div class="section-divider"></div>

				<!-- OFFICE DETAILS Section -->
				<div class="section-header">OFFICE DETAILS</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Region</td>
						<td class="field-value">#{singleComplaintReport.complaints.regionName}</td>
					</tr>
					<tr>
						<td class="field-label">Circle</td>
						<td class="field-value">#{singleComplaintReport.complaints.circleName}</td>
					</tr>
					<tr>
						<td class="field-label">Division</td>
						<td class="field-value">#{singleComplaintReport.complaints.divisionName}</td>
					</tr>
					<tr>
						<td class="field-label">Sub Division</td>
						<td class="field-value">#{singleComplaintReport.complaints.subDivisionName}</td>
					</tr>
					<tr>
						<td class="field-label">Section</td>
						<td class="field-value">#{singleComplaintReport.complaints.sectionName}</td>
					</tr>
				</table>

				<div class="section-divider"></div>

				<!-- CLOSURE DETAILS Section -->
				<!-- <div class="section-header">CLOSURE DETAILS</div>
                <table class="details-table">
                    <tr>
                        <td class="field-label">Closed Date</td>
                        <td class="field-value">#{singleComplaintReport.complaints.attendedDate}</td>
                    </tr>
                    <tr>
                        <td class="field-label">Closed Remarks</td>
                        <td class="field-value">#{singleComplaintReport.complaints.attendedRemarks}</td>
                    </tr>
                </table>-->

				<div class="section-divider"></div>

				<!-- FEEDBACK DETAILS Section -->
				<div class="section-header">FEEDBACK DETAILS</div>
				<table class="details-table">
					<tr>
						<td class="field-label">Feedback Remarks</td>
						<td class="field-value">#{singleComplaintReport.complaints.feedback}</td>
					</tr>
					<tr>
						<td class="field-label">Feedback Rating</td>
						<td class="field-value">#{singleComplaintReport.complaints.feedbackRating}</td>
					</tr>
					<tr>
						<td class="field-label">Feedback Given Date</td>
						<td class="field-value">#{singleComplaintReport.complaints.feedBackEntryDate}</td>
					</tr>
				</table>


				<!-- TRANSFER DETAILS Section -->
				<div class="section-header">TRANSFER HISTORY</div>
				<p:dataTable
					value="#{singleComplaintReport.complaints.transferDetails}"
					var="transfer" styleClass="details-table" rowIndexVar="rowIndex">
					<p:column headerText="S.No">
						<h:outputText value="#{rowIndex + 1}" />
					</p:column>
					<p:column headerText="Transfer Date">
						<h:outputText value="#{transfer.transferDate}" />
					</p:column>
					<p:column headerText="Transferred By">
						<h:outputText value="#{transfer.transferredBy}" />
					</p:column>
					<p:column headerText="Remarks">
						<h:outputText value="#{transfer.transferRemarks}" />
					</p:column>
				</p:dataTable>
				
				
 <!-- RESEND DETAILS Section -->
                <div class="section-header">RESEND HISTORY</div>
                <p:dataTable value="#{singleComplaintReport.complaints.resendDetails}" var="resend"
                             styleClass="details-table" rowIndexVar="rowIndex">
                    <p:column headerText="S.No">
                        <h:outputText value="#{rowIndex + 1}"/>
                    </p:column>
                    <p:column headerText="Resend Date">
                        <h:outputText value="#{resend.resendDate}"/>
                    </p:column>
                    <p:column headerText="Resended By">
                        <h:outputText value="#{resend.resendedBy}"/>
                    </p:column>
                    <p:column headerText="Remarks">
                        <h:outputText value="#{resend.resendRemarks}"/>
                    </p:column>
                </p:dataTable>

				<!-- QUALITY CHECK DETAILS Section -->
				<div class="section-header">QUALITY CHECKS</div>
				<p:dataTable
					value="#{singleComplaintReport.complaints.qualityCheckDetails}"
					var="qc" styleClass="details-table" rowIndexVar="rowIndex">
					<p:column headerText="S.No">
						<h:outputText value="#{rowIndex + 1}" />
					</p:column>
					<p:column headerText="QC Date">
						<h:outputText value="#{qc.qcDate}" />
					</p:column>
					<p:column headerText="Status">
						<h:outputText value="#{qc.qcStatus}" />
					</p:column>
					<p:column headerText="Remarks">
						<h:outputText value="#{qc.qcRemarks}" />
					</p:column>
				</p:dataTable>
				<div class="section-divider"></div>
				<div class="section-header">IMAGES DURING REGISTRATION</div>

				<!-- For Image 1 -->
				<ui:fragment
					rendered="#{not empty singleComplaintReport.complaints.image1}">
					<div style="margin-bottom: 20px;">
						<h6 style="margin-bottom: 8px; color: #444;">Image 1</h6>
						<!--         <div style="display: flex; flex-direction: column; gap: 5px;"> -->
						<img src="#{singleComplaintReport.getImagePath(singleComplaintReport.complaint.image1)}"
                alt="#{singleComplaintReport.complaint.image1}"
                style="max-width: 500px; max-height: 400px; border: 1px solid #ddd; padding: 5px;"/>
						<!--  </div> -->
					</div>
				</ui:fragment>

				<!-- For Image 2 -->
				<ui:fragment
					rendered="#{not empty singleComplaintReport.complaints.image2}">
					<div style="margin-bottom: 20px;">
						<h6 style="margin-bottom: 8px; color: #444;">Image 2</h6>
						<!--  <div style="display: flex; flex-direction: column; gap: 5px;"> -->
						<img src="#{singleComplaintReport.getImagePath(singleComplaintReport.complaint.image2)}"
                alt="#{singleComplaintReport.complaint.image2}"
                style="max-width: 500px; max-height: 400px; border: 1px solid #ddd; padding: 5px;"/>
						<!--   </div> -->
					</div>
				</ui:fragment>

				<ui:fragment
					rendered="#{empty singleComplaintReport.complaints.image1 and empty singleComplaintReport.complaints.image2}">
					<div
						style="padding: 15px; background: #f5f5f5; border-radius: 4px; text-align: center; color: #666;">
						No complaint registration images available</div>
				</ui:fragment>


			</ui:fragment>
			<hr class="my-3" />

			<!-- Outer container -->
			<div class="container">
				<div class="row">
					<!-- Type and Reason Row -->
					<div class="form-row mb-4 w-100">

						<!-- Type of Closure -->
						<div class="form-group col-md-6">
							<label for="ctype" class="col-form-label"> Type of
								Closure <span style="color: red;">*</span>
							</label>
							<p:selectOneMenu id="ctype" widgetVar="ctypeWidget"
								value="#{singleComplaintReport.selectedClosureType}"
								style="width: 100%;" onchange="selecttype();">

								<f:selectItem itemLabel="---- Select Closure Type ----"
									itemValue="" />

								<!-- Interim Closure: Disabled if status is 'In Progress' -->
								<f:selectItem itemLabel="Interim Closure" itemValue="1"
									itemDisabled="#{singleComplaintReport.complaints.complaintStatusValue eq 'In Progress'}" />

								<!-- Final Closure: Always enabled -->
								<f:selectItem itemLabel="Final Closure" itemValue="2" />

							</p:selectOneMenu>

							<span id="singleComplaintForm:errorMsg" class="error"
								style="color: red; display: none;">Please select Type</span>
						</div>

						<!-- Closure Reason -->
						<div class="form-group col-md-6">
							<label for="ddCompletionReason" class="col-form-label">
								Closure Reason <span style="color: red;">*</span>
							</label>
							<p:selectOneMenu id="ddCompletionReason"
								value="#{singleComplaintReport.selectedReasonId}"
								widgetVar="reasonWidget" style="width: 100%;"
								onchange="selecttype();">
								<f:selectItem itemLabel="-- Select Reason --" itemValue="" />
								<f:selectItems value="#{singleComplaintReport.lstReasons}"
									var="reason" itemLabel="#{reason.closureReason}"
									itemValue="#{reason.id}" />
							</p:selectOneMenu>
							<span id="singleComplaintForm:errorMsgreason" class="error"
								style="color: red; display: none;">Please select Reason</span>
						</div>
					</div>
				
					<div class="row mb-4" id="myDiv" style="display:none;">
    <div class="col-md-12">
        <div class="card">
            <div class="card-body">
                <div class="mb-3">
                    <label class="form-label fw-bold">Upload Image</label>
                    <div class="file-upload-wrapper">
                        <p:fileUpload 
                            value="#{singleComplaintReport.file}"
                            mode="simple"
                            skinSimple="true"
                            styleClass="custom-file-upload"
                              id="imagePreview"
                            label="Choose File"
                            allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                            invalidFileMessage="Only images (JPG, PNG, GIF) are allowed"
                            update="@form"
                            auto="false" />
                    </div>
                    <small class="text-muted">Maximum file size: 2MB. Supported formats: JPG, PNG, GIF</small>
                </div>
            </div>
        </div>
    </div>
</div>

<style>

</style>
					         
										<!-- Description -->
					<div class="form-group col-md-12 mb-4">
						<label for="remarkId" class="col-form-label"> Description
							<span style="color: red;">*</span>
						</label>
						<p:inputTextarea id="remarkId"
							value="#{singleComplaintReport.remarks}" rows="4" cols="35"
							style="width: 100%;" counter="displayClose" maxlength="250"
							counterTemplate="{0} characters remaining." autoResize="false" />
						<h:outputText id="displayClose" style="color:gray;" />
					</div>

					<!-- Buttons -->
					<div class="form-group col-md-12 text-right">
						<p:commandButton value="Submit"
							update="ctype ddCompletionReason remarkId displayClose"
							styleClass="btn btn-md btn-primary"
							style="border-radius: 3px; padding: 10px 20px;"
							onclick="if (validateCloseComplaint()) { PF('confirmDlgWidget').show(); } return false;">
							<f:param name="compId"
								value="#{singleComplaintReport.selectedComplaintId.id}" />
						</p:commandButton>

						<p:commandButton value="Reset" type="button"
							styleClass="btn btn-md btn-secondary"
							style="background-color: coral; margin-left: 10px; border-radius: 3px; padding: 10px 20px;"
							onclick="resetClosureForm();" />
					</div>
				</div>
			</div>

			<p:confirmDialog id="confirmDlg" widgetVar="confirmDlgWidget"
				header="Confirm" styleClass="custom-confirm-dialog"
				draggable="false" modal="true" resizable="false" closable="false"
				focus="true">

				<h:outputText
					style="   display: block;
    text-align: center;
    font-size: 18px;
    
    font-weight: 600;
    color: #333;
    margin-bottom: 40px; /* adds space below the message */
    padding: 10px 0;      /* optional top padding for spacing from header */
    font-family: sans-serif;"
					value="Want to submit Yes/No" styleClass="confirm-message">
				</h:outputText>
				<div style="display: flex; gap: 10px;">
					<p:commandButton value="Yes"
						action="#{singleComplaintReport.circleCloseComplaintsCallCenterUser}"
						oncomplete="PF('confirmDlgWidget').hide()"
						styleClass="btn btn-primary"
						style="background-color: #35ab61 !important;
                            height: 38px;
                            width: 65px;
                            font-size: 16px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            text-align: center;
                            padding: 0;">
						<f:setPropertyActionListener
							target="#{singleComplaintReport.complaintCloseId}"
							value="#{singleComplaintReport.selectedComplaintId.id}" />

					</p:commandButton>

					<p:commandButton value="No" type="button"
						onclick="PF('confirmDlgWidget').hide()"
						styleClass="btn btn-secondary"
						style="background-color: red !important;
                            height: 38px;
                            width: 65px;
                            font-size: 16px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            text-align: center;
                            padding: 0;" />
				</div>

			</p:confirmDialog>
			
			<p:dialog header="Complaint Details" modal="true"
				widgetVar="complaintDialogs" showEffect="drop" hideEffect="drop"
				width="1150" height="600" draggable="true" closable="false">
				<p:outputPanel id="pnlcomp1">
					<h:outputText value="COMPLAINT DETAILS"
						style="font-weight: bold; margin-bottom: 20px; display: block;padding: 10px;
							 background: #d4d4d4;
							 color: #000;
							 border-radius: 3px;"
						styleClass="ui-widget-header" />
					<h:panelGrid columns="3" cellpadding="10"
						style="width: 100%; margin-bottom: 30px;">
						<h:outputText value="Complaint Id:" style="font-weight: bold;" />
						<h:outputText value="Complaint Date:" style="font-weight: bold;" />
						<h:outputText value="Complaint Description:"
							style="font-weight: bold;" />

						<p:commandLink
							value="#{singleComplaintReport.selectedComplaintId.id}"
							styleClass="link-class"
							actionListener="#{singleComplaintReport.getComplaintDetailForAbstractReport}">
							<f:param name="compId"
								value="#{singleComplaintReport.selectedComplaintId.id}" />
						</p:commandLink>

						<h:outputText
							value="#{singleComplaintReport.selectedComplaintId.createdOnFormatted}" />
						<h:outputText
							value="#{singleComplaintReport.selectedComplaintId.description}" />
					</h:panelGrid>


					<!-- <hr class="my-3" /> -->

					<!-- Second Row: Two Columns -->
					<h:outputText value="CLOSURE DETAILS"
						style="font-weight: bold; margin-bottom: 30px; display: block;padding: 10px;
									    background: #d4d4d4;
									    color: #000;
									    border-radius: 3px;"
						styleClass="ui-widget-header" />
					<h:panelGrid columns="4" cellpadding="10"
						style="width: 100%; margin-bottom: 30px;">
						<h:outputText value="Date of Completion:"
							style="font-weight: bold;" />
						<h:outputText value="AE Contact Number:"
							style="font-weight: bold;" />

						<h:outputText value="Completion Remarks:"
							style="font-weight: bold;" />
						<h:outputText value="FeedBack Remarks:" style="font-weight: bold;" />

						<h:outputText
							value="#{singleComplaintReport.selectedComplaintId.updatedOnFormatted}" />
						<h:commandButton value="#{singleComplaintReport.adminMobile}"
							action="#{singleComplaintReport.loadAdminMobile}" />
						<h:outputText
							value="#{singleComplaintReport.selectedComplaintId.finalDescription}" />
					</h:panelGrid>


					<!--  <hr class="my-3" /> -->

					<h:outputText value="CONSUMER CONTACT DETAILS"
						style="font-weight: bold; margin-bottom: 20px; display: block;padding: 10px;
						    background: #d4d4d4;
						    color: #000;
						    border-radius: 3px;"
						styleClass="ui-widget-header" />
					<h:panelGrid columns="1" cellpadding="10" style="width: 100%; ">
						<h:panelGroup layout="block"
							style="display: flex; gap: 20px; width: 100%; paddin-bottom:0px !important;">

							<!-- Left Column: Contact Number (50%) -->
							<h:panelGrid columns="2" cellpadding="10" style="flex: 1;"
								styleClass="contact-table">
								<h:outputText value="Contact Number:" style="font-weight: bold;" />
								<h:outputText
									value="#{singleComplaintReport.selectedComplaintMobileNumber.contactNo}"
									style="color: #007bff; font-weight: bold;paddin-bottom:0px !important;" />
							</h:panelGrid>

							<!-- Right Column: Remarks (50%) -->
							<h:panelGrid columns="2" cellpadding="10" style="flex: 1;">
								<h:outputText value="Remarks: *"
									style="font-weight: bold; color: red;" />
								<h:inputTextarea id="remarks"
									value="#{singleComplaintReport.closureDescriptionComplete}"
									style="width: 100%;" rows="3" />
							</h:panelGrid>

						</h:panelGroup>
						<!-- Footer Buttons -->
						<f:facet name="footer" class="modal-footer">
							<p:commandButton value="Submit"
								styleClass="btn btn-md btn-primary"
								style="border-radius: 3px !important; padding: 10px !important;"
								action="#{singleComplaintReport.closureQcComplaint}"
								onclick="return validateRemarks();">
								<f:param name="compId"
									value="#{singleComplaintReport.selectedComplaintId.id}" />
							</p:commandButton>
							<p:commandButton value="Resend"
								styleClass="btn btn-md btn-danger"
								style="border-radius: 3px !important; padding: 10px !important;margin-left: 10px;"
								action="#{singleComplaintReport.closureResendComplaint}"
								onclick="return validateRemarks();">
								<f:param name="compId"
									value="#{singleComplaintReport.selectedComplaintId.id}" />
							</p:commandButton>
							<p:commandButton value="Close" styleClass="btn btn-md btn-danger"
								style="border-radius: 3px !important; padding: 10px !important;margin-left: 10px;"
								action="#{singleComplaintReport.closepage}">

							</p:commandButton>
						</f:facet>
					</h:panelGrid>


				</p:outputPanel>
			</p:dialog>

			<!--	T H I S   M O D A L   I S   F O R  R E S E N D    C O M P A L I N T S -->


			<!--	T H I S   M O D A L   I S   F O R   V I E W I N G  P R O F I L E -->


			<!--	T H I S   M O D A L   I S   F O R   V I E W I N G  C H A N G E  P A S S W O R D -->
			<!--  	<f:metadata>
		    <f:viewAction action="#{admin.callCenterUser.init}" />
		</f:metadata>-->


			<p:dialog id="confirmationDialog" header="Password Changed"
				widgetVar="confirmationDialog" modal="true" showEffect="fade"
				hideEffect="fade">
				<div class="form-group mb-1">
					<h:outputText value="Login with your new password." />
					<p:commandButton value="OK" styleClass="btn btn-danger"
						action="#{admin.auth.callCenterLogOut()}" />
				</div>
			</p:dialog>

			<p:dialog id="messageDialog" widgetVar="messageDialog" modal="true"
				showEffect="fade" hideEffect="fade" closable="false" width="400"
				height="50">
				<h:outputText id="dialogMessage"
					value="The Consumer is not satisfied. The complaint is resent to the concerned Section officer."
					style="font-size: 20px; text-align: center; display: block;" />

			</p:dialog>

			<p:dialog id="messageDialogClose" widgetVar="messageDialogClose"
				modal="true" showEffect="fade" hideEffect="fade" closable="false"
				width="400" height="50">
				<h:outputText id="dialogMessageClose"
					value="Complaint closed successfully."
					style="font-size: 20px; text-align: center; display: block;" />

			</p:dialog>

			<p:dialog id="messageDialogSuccess" widgetVar="messageDialogSuccess"
				modal="true" showEffect="fade" hideEffect="fade" closable="false"
				width="420" height="140" styleClass="success-dialog">

				<div
					style="display: flex; align-items: center; justify-content: center; gap: 15px; padding: 25px;">
					<i class="pi pi-check-circle"
						style="font-size: 2.5em; color: green;"></i>
					<h:outputText id="dialogMessageSuccess"
						value="Complaint saved to QC."
						style="font-size: 24px; color: #2e7d32; font-weight: 800;" />
				</div>
			</p:dialog>
			<p:dialog id="messageDialogError" widgetVar="messageDialogError"
				modal="true" showEffect="fade" hideEffect="fade" closable="false"
				width="420" height="140" styleClass="success-dialog">

				<div
					style="display: flex; align-items: center; justify-content: center; gap: 15px; padding: 25px;">
					<i class="pi pi-check-circle" style="font-size: 2.5em; color: red;"></i>
					<h:outputText id="dialogMessageError"
						value="Unable to close your complaint."
						style="font-size: 24px; color: #2e7d32; font-weight: 800;" />
				</div>
			</p:dialog>
			<!-- resend dialog -->
			<p:dialog id="messageDialogComplaintResend"
				widgetVar="messageDialogComplaintResend" modal="true"
				showEffect="fade" hideEffect="fade" closable="false" width="520"
				height="240" styleClass="success-dialog">

				<div
					style="display: flex; align-items: center; justify-content: center; gap: 15px; padding: 25px;">
					<i class="pi pi-check-circle"
						style="font-size: 2.5em; color: green;"></i>
					<h:outputText id="dialogMessageComplaintResend"
						value="The Consumer is not satisfied. The complaint is resent to the concerned Section officer"
						style="font-size: 24px; color: #2e7d32; font-weight: 800;" />
				</div>
			</p:dialog>
			<p:dialog id="messageDialogComplaintResendError"
				widgetVar="messageDialogComplaintResendError" modal="true"
				showEffect="fade" hideEffect="fade" closable="false" width="420"
				height="140" styleClass="success-dialog">

				<div
					style="display: flex; align-items: center; justify-content: center; gap: 15px; padding: 25px;">
					<i class="pi pi-check-circle" style="font-size: 2.5em; color: red;"></i>
					<h:outputText id="dialogMessageComplaintResendError"
						value="Unable to close your complaint."
						style="font-size: 24px; color: #2e7d32; font-weight: 800;" />
				</div>
			</p:dialog>
			<p:dialog id="messageDialogalreadyexists"
				widgetVar="messageDialogalreadyexists" modal="true"
				showEffect="fade" hideEffect="fade" closable="false" width="420"
				height="160" styleClass="success-dialog">

				<div
					style="display: flex; align-items: center; justify-content: center; gap: 15px; padding: 25px;">
					<i class="pi pi-times-circle"
						style="font-size: 2.5em; color: green;"></i>
					<h:outputText id="dialogMessageErroralreadyexists"
						value="The complaint rectification work is under process"
						style="font-size: 24px; color: green; font-weight: 800; text-align: center;" />
				</div>
			</p:dialog>
			<p:dialog id="messageDialogalreadyexists1"
				widgetVar="messageDialogalreadyexists1" modal="true"
				showEffect="fade" hideEffect="fade" closable="false" width="420"
				height="160" styleClass="success-dialog">

				<div
					style="display: flex; align-items: center; justify-content: center; gap: 15px; padding: 25px;">
					<i class="pi pi-times-circle"
						style="font-size: 2.5em; color: green;"></i>
					<h:outputText id="dialogMessageErroralreadyexists1"
						value="Complaint Closed Successfully"
						style="font-size: 24px; color: green; font-weight: 800; text-align: center;" />
				</div>
			</p:dialog>
	 <p:dialog id="filesize"
          widgetVar="filesize"
          modal="true"
          header="Image Upload Error"
          showEffect="fade"
          hideEffect="fade"
          closable="true"
          width="420"
          height="160"
          styleClass="error-dialog">

    <div style="display: flex; align-items: center; justify-content: center; gap: 15px; padding: 25px;">
        <i class="pi pi-times-circle" style="font-size: 2.5em; color: red;"></i>
        <h:outputText id="filesize1"
                      value="File size exceeds 1MB. Please upload a smaller image."
                      style="font-size: 20px; color: red; font-weight: 800; text-align: center;" />
    </div>
</p:dialog>
		</h:form>
	</div>
</h:body>
<!-- <script>
function clearSearchFilter(){
    window.location.reload();
}
</script> -->
</html>